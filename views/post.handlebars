<div class="page">

    <nav class="navbar navbar-expand-lg navBar" style="background-color: #e3f2fd;">
        <a class="navbar-brand title" href="/">FoodDex</a>
        <div class="collapse navbar-collapse" id="navbarColor03">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link quickLink" href="/">Home</a>
                </li>
            </ul>
            <form class="form-inline">
                <input class="form-control mr-sm-2" type="search" placeholder="Search Title" aria-label="Search">
                <a class="my-2 my-sm-0 searchButton" type="submit">Search Recipes</a>
            </form>
        </div>
    </nav>

    <div class="container">
        <h1>Post a Bite</h1>

        <form>
            <div class="form-group">
                <label for="biteTitleInput">Bite Title</label>
                <input type="text" class="form-control" id="biteTitleInput" placeholder="Vegan Alfredo">
            </div>
            <div class="form-group">
                <label for="preparationInput">Bite Preparation</label>
                <textarea class="form-control" id="preparationInput" rows="3" placeholder="A great dish for the family!"></textarea>
            </div>
            <div class="form-group">
                <label for="ingredientsInput">Ingredients (Separated by '*')</label>
                <textarea class="form-control" id="ingredientsInput" rows="3" placeholder="Describe how to make it!"></textarea>
            </div>
            <div class="form-group">
                <label for="coverPhotoInput">Cover Photo</label>
                <input type="file" class="form-control-file" id="coverPhotoInput">
            </div>
        </form>
        <button class="loginButton postBiteButton" >Post Bite!</button>
    </div>

</div>

<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
<link href="../public/styles/styles.css" rel="stylesheet" >
<link href="https://fonts.googleapis.com/css?family=Roboto+Condensed&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://sdk.amazonaws.com/js/aws-sdk-2.1.12.min.js"></script>
<script type="text/javascript">
    let S3 = new AWS.S3();
    let timerId;

    $(document).on("click", ".postBiteButton", function (e) {
        let file = document.getElementById("coverPhotoInput").files[0];
        var fd = new FormData();
        fd.append("file", file);
        fd.append("title", $("#biteTitleInput").val());
        fd.append("ingredients", $("#ingredientsInput").val());
        fd.append("preparation", $("#preparationInput").val());

        $("#biteTitleInput").val("");
        $("#ingredientsInput").val("");
        $("#preparationInput").val("");
        document.getElementById("coverPhotoInput").files.length = 0;

        $.ajax({
            url: "/api/upload",
            type: "post",
            data: fd,
            contentType: false,
            processData: false
        }).then(function (res) {
        }).catch(function (err) {});
        if (!timerId) {
            timerId = setTimeout(() => {
                location.replace("/");
            }, 3000);
        }
    });

</script>